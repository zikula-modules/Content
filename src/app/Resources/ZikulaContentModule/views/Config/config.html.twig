{# purpose of this template: module configuration page #}
{% extends 'ZikulaContentModule::adminBase.html.twig' %}
{% block title __('Settings') %}
{% block admin_page_icon 'wrench' %}
{% block content %}
    <div class="zikulacontentmodule-config">
        {% form_theme form with [
            '@ZikulaContentModule/Form/bootstrap_3.html.twig',
            'ZikulaFormExtensionBundle:Form:form_div_layout.html.twig'
        ] %}
        {{ form_start(form) }}
        <div class="zikula-bootstrap-tab-container">
            <ul class="nav nav-tabs">
                {% set tabTitle = __('General settings') %}
                <li role="presentation" class="active">
                    <a id="vars1Tab" href="#tab1" title="{{ tabTitle|e('html_attr') }}" role="tab" data-toggle="tab">{{ tabTitle }}</a>
                </li>
                {% set tabTitle = __('Custom styles') %}
                <li role="presentation">
                    <a id="vars2Tab" href="#tab2" title="{{ tabTitle|e('html_attr') }}" role="tab" data-toggle="tab">{{ tabTitle }}</a>
                </li>
                {% set tabTitle = __('Additional fields') %}
                <li role="presentation">
                    <a id="vars3Tab" href="#tab3" title="{{ tabTitle|e('html_attr') }}" role="tab" data-toggle="tab">{{ tabTitle }}</a>
                </li>
                {% set tabTitle = __('Permalinks') %}
                <li role="presentation">
                    <a id="vars4Tab" href="#tab4" title="{{ tabTitle|e('html_attr') }}" role="tab" data-toggle="tab">{{ tabTitle }}</a>
                </li>
                {% set tabTitle = __('List views') %}
                <li role="presentation">
                    <a id="vars5Tab" href="#tab5" title="{{ tabTitle|e('html_attr') }}" role="tab" data-toggle="tab">{{ tabTitle }}</a>
                </li>
                {#{% set tabTitle = __('Integration') %}
                <li role="presentation">
                    <a id="vars6Tab" href="#tab6" title="{{ tabTitle|e('html_attr') }}" role="tab" data-toggle="tab">{{ tabTitle }}</a>
                </li>
                {% set tabTitle = __('Workflows') %}
                <li role="presentation">
                    <a id="workflowsTab" href="#tabWorkflows" title="{{ tabTitle|e('html_attr') }}" role="tab" data-toggle="tab">{{ tabTitle }}</a>
                </li>#}
                {% set tabTitle = __('Available plugins', 'zikula') %}
                <li role="presentation">
                    <a id="pluginsTab" href="#tabPlugins" title="{{ tabTitle|e('html_attr') }}" role="tab" data-toggle="tab">{{ tabTitle }}</a>
                </li>
            </ul>

            {{ form_errors(form) }}
            <div class="tab-content">
                <div role="tabpanel" class="tab-pane fade in active" id="tab1" aria-labelledby="vars1Tab">
                    {% set tabTitle = __('General settings') %}
                    <fieldset>
                        <legend>{{ tabTitle }}</legend>
                    
                        <p class="alert alert-info">{{ __('Here you can manage all basic settings for this application.') }}</p>
                    
                        {{ form_row(form.stateOfNewPages) }}
                        {{ form_row(form.countPageViews) }}
                        {{ form_row(form.googleMapsApiKey, {
                            'input_group': {
                                'right': '<a href="https://developers.google.com/maps/documentation/javascript/get-api-key#key" target="_blank"><i class="fa fa-key"></i></a>'
                            }
                        }) }}
                        {{ form_row(form.enableRawPlugin) }}
                        {{ form_row(form.inheritPermissions) }}
                    </fieldset>
                </div>
                <div role="tabpanel" class="tab-pane fade" id="tab2" aria-labelledby="vars2Tab">
                    {% set tabTitle = __('Custom styles') %}
                    <fieldset>
                        <legend>{{ tabTitle }}</legend>
                    
                        <p class="alert alert-info">{{ __('With custom styles you can add and reuse your own design to pages, page sections and content elements. Write one class name on each line. Please separate the CSS classes and displaynames with | - eg. "my-class | My class".')|nl2br }}</p>
                    
                        {{ form_row(form.pageStyles) }}
                        {{ form_row(form.sectionStyles) }}
                        {{ form_row(form.contentStyles) }}
                    </fieldset>
                </div>
                <div role="tabpanel" class="tab-pane fade" id="tab3" aria-labelledby="vars3Tab">
                    {% set tabTitle = __('Additional fields') %}
                    <fieldset>
                        <legend>{{ tabTitle }}</legend>
                    
                        <p class="alert alert-info">{{ __('Here you can activate additional fields which allow you to add structural properties to your pages which can be used for custom functionality. All of these fields are translatable.')|nl2br }}</p>
                    
                        {{ form_row(form.enableOptionalString1) }}
                        {{ form_row(form.enableOptionalString2) }}
                        {{ form_row(form.enableOptionalText) }}
                    </fieldset>
                </div>
                <div role="tabpanel" class="tab-pane fade" id="tab4" aria-labelledby="vars4Tab">
                    {% set tabTitle = __('Permalinks') %}
                    <fieldset>
                        <legend>{{ tabTitle }}</legend>
                    
                        <p class="alert alert-info">{{ __('Here you can customise the behaviour of creating permalinks for content pages.')|nl2br }}</p>
                    
                        {{ form_row(form.ignoreBundleNameInRoutes) }}
                        {{ form_row(form.ignoreEntityNameInRoutes) }}
                        {{ form_row(form.ignoreFirstTreeLevelInRoutes) }}
                    </fieldset>
                </div>
                <div role="tabpanel" class="tab-pane fade" id="tab5" aria-labelledby="vars5Tab">
                    {% set tabTitle = __('List views') %}
                    <fieldset>
                        <legend>{{ tabTitle }}</legend>
                    
                        <p class="alert alert-info">{{ __('Here you can configure parameters for list views.')|nl2br }}</p>
                    
                        {{ form_row(form.pageEntriesPerPage) }}
                        {{ form_row(form.linkOwnPagesOnAccountPage) }}
                        {{ form_row(form.showOnlyOwnEntries) }}
                    </fieldset>
                </div>
                <div role="tabpanel" class="tab-pane fade hidden" id="tab6" aria-labelledby="vars6Tab">
                    {% set tabTitle = __('Integration') %}
                    <fieldset>
                        <legend>{{ tabTitle }}</legend>
                    
                        <p class="alert alert-info">{{ __('These options allow you to configure integration aspects.')|nl2br }}</p>
                    
                        {{ form_row(form.enabledFinderTypes) }}
                    </fieldset>
                </div>
                {#
                <div role="tabpanel" class="tab-pane fade" id="tabWorkflows" aria-labelledby="workflowsTab">
                    {% set tabTitle = __('Workflows') %}
                    <fieldset>
                        <legend>{{ tabTitle }}</legend>
                
                        <p class="alert alert-info">{{ __('Here you can inspect and amend the existing workflows.') }}</p>
                
                        <h4>{{ __('Pages') }}</h4>
                        <p><a href="{{ path('zikula_workflow_editor_index', {workflow: 'zikulacontentmodule_none'}) }}" title="{{ __('Edit workflow for pages') }}" target="_blank"><i class="fa fa-cubes"></i> {{ __('Edit pages workflow') }}</a>
                        <h4>{{ __('Content items') }}</h4>
                        <p><a href="{{ path('zikula_workflow_editor_index', {workflow: 'zikulacontentmodule_none'}) }}" title="{{ __('Edit workflow for content items') }}" target="_blank"><i class="fa fa-cubes"></i> {{ __('Edit content items workflow') }}</a>
                    </fieldset>
                </div>
                #}
                <div role="tabpanel" class="tab-pane fade" id="tabPlugins" aria-labelledby="pluginsTab">
                    {% set tabTitle = __('Available plugins', 'zikula') %}
                    <fieldset>
                        <legend>{{ tabTitle }}</legend>
                        <p class="alert alert-info">{{ __('Content allows other bundles/modules to provide additional content elements. Moreover some modules introduce extra functions to plugins delivered with Content. The following list shows which plugins are available at your installation.', 'zikula') }}</p>
                        {% set allContentTypes = zikulacontentmodule_contentTypes(true) %}
                        <div class="table-responsive">
                            <table class="table table-striped table-bordered table-hover table-condensed">
                                <colgroup>
                                    <col id="cBundle" />
                                    <col id="cPlugin" />
                                    <col id="cActive" />
                                    <col id="cCategory" />
                                    <col id="cDescription" />
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th id="hBundle" scope="col">{{ __('Bundle') }}</th>
                                        <th id="hPlugin" scope="col">{{ __('Plugin') }}</th>
                                        <th id="hActive" scope="col">{{ __('Active') }}</th>
                                        <th id="hCategory" scope="col">{{ __('Category') }}</th>
                                        <th id="hDescription" scope="col">{{ __('Description') }}</th>
                                    </tr>
                                </thead>
                                <tbody>
                                {% for contentType in allContentTypes %}
                                    <tr>
                                        <td headers="h{{ contentType.name }} hBundle">{{ contentType.bundleName }}</td>
                                        <th id="h{{ contentType.name }}" scope="row" headers="hPlugin" class="nowrap">
                                            <i class="fa fa-fw fa-{{ contentType.icon|e('html_attr') }}"></i> {{ contentType.title }}
                                        </th>
                                        <td headers="h{{ contentType.name }} hActive" class="text-center text-{% if contentType.active %}success{% else %}danger{% endif %}">
                                            {% if contentType.active %}
                                                <i class="fa fa-check" title="{{ __('Yes') }}"></i>
                                            {% else %}
                                                <i class="fa fa-times" title="{{ __('No') }}"></i>
                                            {% endif %}
                                        </td>
                                        <td headers="h{{ contentType.name }} hCategory">
                                            {{ contentType.category }}
                                        </td>
                                        <td headers="h{{ contentType.name }} hDescription">
                                            {{ contentType.description }}
                                            {% if contentType.adminInfo|default %}<br /><span class="label label-default">{{ contentType.adminInfo }}</span>{% endif %}
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </fieldset>
                </div>
            </div>
        </div>

        <div class="form-group form-buttons">
            <div class="col-sm-offset-3 col-sm-9">
                {{ form_widget(form.save) }}
                {{ form_widget(form.reset) }}
                {{ form_widget(form.cancel) }}
            </div>
        </div>
        {{ form_end(form) }}
    </div>
{% endblock %}
{% block footer %}
    {{ parent() }}
    {{ pageAddAsset('javascript', zasset('@ZikulaContentModule:js/ZikulaContentModule.Validation.js'), 98) }}
    {{ pageAddAsset('javascript', zasset('@ZikulaContentModule:js/ZikulaContentModule.EditFunctions.js'), 99) }}
    {% set formInitScript %}
        <script>
        /* <![CDATA[ */
            ( function($) {
                $(document).ready(function() {
                    zikulaContentInitEditForm('edit', '1');
                });
            })(jQuery);
        /* ]]> */
        </script>
    {% endset %}
    {{ pageAddAsset('footer', formInitScript) }}
{% endblock %}
